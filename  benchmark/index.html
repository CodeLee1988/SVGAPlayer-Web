<!DOCTYPE html>
<html>
<head>
  <title>Lite</title>
  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.11/lodash.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/platform/1.3.5/platform.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/benchmark/2.1.4/benchmark.min.js"></script>
</head>
<body>
  <div id="log"></div>
  <canvas id="canvas1"></canvas>
  <canvas id="canvas2"></canvas>

  <script>
    var log = document.body.querySelector('#log')
    var suite = new Benchmark.Suite
    var svgaFile = './assets/angel.svga'

    suite
      // .add('RegExp#test', function () {
      //   /o/.test('Hello World!')
      // })
      // .add('String#indexOf', function () {
      //   'Hello World!'.indexOf('o') > -1
      // })
      .add('Test#lite.worker', function (deferred) {
        var script = document.createElement('script')
        script.type = 'text/javascript'
        script.src = '../tests/svga.lite.min.js'
        document.getElementsByTagName('head')[0].appendChild(script)

        script.onload = () => {
          var downloader = new SVGA.Downloader(svgaFile)
          var parser = new SVGA.Parser()
          // var player = new window.SVGALite.Player('#canvas')

          downloader.request().then(function (fileData) {
            parser.do(fileData).then(function (svgaData) {
              // player.mount(svgaData).then(function () {
              //   player.start()
              // })
              deferred.resolve()
            })
          })
        }
      },  {defer: true})
      .add('Test#webplayer', function (deferred) {
        var script = document.createElement('script')
        script.type = 'text/javascript'
        script.src = './svga.min.js'
        document.getElementsByTagName('head')[0].appendChild(script)
        script.onload = () => {
          // var player = new SVGA.Player('#canvas')
          var parser = new SVGA.Parser('#canvas')

          parser.load(svgaFile, function(videoItem) {
            // player.setVideoItem(videoItem)
            // player.startAnimation()
            deferred.resolve()
          })
        }
      },  {defer: true})
      .on('cycle', function(event) {
        log.innerHTML += `<p>${String(event.target)}</p>`
      })
      .run({ 'async': true })
  </script>
</body>
</html>
